(this.webpackJsonpreact_client=this.webpackJsonpreact_client||[]).push([[0],{174:function(e,t,a){},276:function(e,t,a){},277:function(e,t,a){"use strict";a.r(t);var n=a(2),r=a(0),o=a.n(r),c=a(17),s=a.n(c),i=(a(174),a(14)),l=a(141),u=a(16),d=a(7),p=a(21),b=a(106),j=a(70),h=a(8),f=a.n(h),m=a(13),O=a(137),g=a.n(O),x=a(136),v=a.n(x),y=a(316),w=a(318),k=a(351),_=a(324),C=a(325),S=a(6),N=a(350),I=a(317),E=Object(S.a)((function(e){return Object(N.a)({body:{fontSize:14,padding:0,maxWidth:"10ch"}})}))(y.a),L=Object(S.a)((function(e){return Object(N.a)({root:{"&:nth-of-type(odd)":{backgroundColor:e.palette.background.default},"&:nth-of-type(even)":{backgroundColor:I.a[800]},"& input":{backgroundColor:"inherit",paddingLeft:0}}})}))(w.a);function B(e){var t=Object(r.useState)({amount:""}),a=Object(i.a)(t,2),o=a[0],c=a[1];function s(e,t){return Object(n.jsx)("datalist",{id:t,children:e.map((function(e){return Object(n.jsx)("option",{value:e.name},e.id)}))})}function l(e){var t=e.target,a=t.name,n=t.value;c(Object(d.a)(Object(d.a)({},o),{},Object(u.a)({},a,n)))}return Object(r.useEffect)((function(){c(e.entry)}),[e.entry]),Object(n.jsxs)(L,{children:[e.fields.filter((function(e){return!e.name.includes("id")})).map((function(t){var a,r,c,i,u,d;return Object(n.jsxs)(E,{children:[Object(n.jsx)(k.a,{name:t.name,onBlur:function(t){e.handleChange(t,e.i)},onChange:l,className:"tableInput",value:o[t.name]||"",inputProps:{list:t.name},InputProps:{startAdornment:Object(n.jsx)(_.a,{position:"start",children:"amount"===t.name?"$":null}),disableUnderline:!0},style:{width:"80%"}}),"person"===t.name&&(null===(a=e.dataLists)||void 0===a?void 0:a.persons)?s(null===(r=e.dataLists)||void 0===r?void 0:r.persons,t.name):null,"narrow_category"===t.name&&(null===(c=e.dataLists)||void 0===c?void 0:c.narrow_categories)?s(null===(i=e.dataLists)||void 0===i?void 0:i.narrow_categories,t.name):null,"broad_category"===t.name&&(null===(u=e.dataLists)||void 0===u?void 0:u.broad_categories)?s(null===(d=e.dataLists)||void 0===d?void 0:d.broad_categories,t.name):null]})})),Object(n.jsx)(E,{children:Object(n.jsx)(C.a,{color:"primary",onClick:function(){return e.handleUpdate(e.i)},children:Object(n.jsx)(v.a,{})})}),Object(n.jsx)(E,{children:Object(n.jsx)(C.a,{"aria-label":"delete",color:"secondary",onClick:function(){return e.deleteEntry(o.id)},children:Object(n.jsx)(g.a,{})})})]})}var A=a(328),T=a(330),P=a(327),F=a(329),U=a(89),D=a(326);function z(e){var t=Object(S.a)((function(e){return Object(N.a)({head:{backgroundColor:e.palette.primary.main,color:e.palette.common.white,padding:10,fontSize:16}})}))(y.a),a=Object(D.a)((function(e){return Object(N.a)({table:{minWidth:650}})}))(),o=Object(r.createRef)();return Object(r.useEffect)((function(){o.current&&o.current.scrollIntoView({behavior:"smooth"})}),[]),Object(n.jsx)(P.a,{component:U.a,children:Object(n.jsxs)(A.a,{className:a.table,ref:o,children:[Object(n.jsx)(F.a,{children:Object(n.jsxs)(w.a,{children:[e.state.schema.fields.filter((function(e){return!e.name.includes("id")})).map((function(e){return Object(n.jsx)(t,{children:e.name.replace("_"," ")},e.name)})),Object(n.jsx)(t,{children:Object(n.jsx)("span",{children:"Save"})}),Object(n.jsx)(t,{children:Object(n.jsx)("span",{children:"Delete"})})]})}),Object(n.jsx)(T.a,{className:"tableBody",children:e.state.data.map((function(t,a){return Object(n.jsx)(B,{entry:t,i:a,fields:e.state.schema.fields,handleChange:e.handleChange,handleUpdate:e.handleUpdate,dataLists:e.dataLists,deleteEntry:e.deleteEntry},a)}))})]})})}function W(e,t){if(401===e.status)throw new Error("Unauthorized");if(404===e.status)throw new Error("No Data");if(200!==e.status)throw new Error("Error! "+e.status);return"json"===t?e.json():e.text()}var M,J={addCategories:function(e,t){return fetch("/api/categories/",{method:"POST",headers:{authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return W(e,"text")}))},getCategories:function(e){return fetch("/api/categories/",{headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return W(e,"json")}))},expenses:function(e,t){return fetch("/api/expenses/".concat(t.year,"/").concat(t.month),{headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return W(e,"json")}))},postExpenses:function(e,t){return fetch("/api/expenses/",{method:"POST",headers:{authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return W(e,"text")}))},postBatchExpenses:function(e,t){return fetch("/api/expenses/batch",{method:"POST",headers:{authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return W(e,"text")}))},postIncome:function(e,t){return fetch("/api/income/",{method:"POST",headers:{authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return W(e,"text")}))},postBatchIncome:function(e,t){return fetch("/api/income/batch",{method:"POST",headers:{authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return W(e,"text")}))},deleteExpenses:function(e,t){return fetch("/api/expenses/".concat(t),{method:"DELETE",headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return W(e,"text")}))},updateExpenses:function(e,t){return fetch("/api/expenses/".concat(t.id),{method:"PUT",headers:{authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return W(e,"text")}))},income:function(e,t){return fetch("/api/income/".concat(t.year,"/").concat(t.month),{headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return W(e,"json")}))},updateIncome:function(e,t){return fetch("/api/income/".concat(t.id),{method:"PUT",headers:{authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return W(e,"text")}))},deleteIncome:function(e,t){return fetch("/api/income/".concat(t),{method:"DELETE",headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return W(e,"text")}))},pivot:function(e,t){return fetch("/api/expenses/".concat(t.year,"/").concat(t.month),{headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return W(e,"json")}))},wallchart:function(e){return fetch("/wallchart",{headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return W(e,"json")}))},dataList:function(e){return fetch("/api/datalists",{headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return W(e,"json")}))},signup:function(e){return fetch("/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return W(e,"text")}))},login:function(e){return fetch("/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return W(e,"json")}))},checkAuth:function(e){return fetch("/auth/checkAuth",{headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return W(e,"json")}))}},R=a(142);function G(){return(G=Object(m.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(R.a)("finances",1,{upgrade:function(e){return Object(m.a)(f.a.mark((function t(){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.createObjectStore("expenses",{autoIncrement:!0}),e.createObjectStore("income",{autoIncrement:!0}),e.createObjectStore("broad_categories",{autoIncrement:!0}),e.createObjectStore("narrow_categories",{autoIncrement:!0}),e.createObjectStore("persons",{autoIncrement:!0}),e.createObjectStore("wallchart",{autoIncrement:!0});case 6:case"end":return t.stop()}}),t)})))()}});case 2:M=e.sent,navigator.onLine&&ne();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $(e,t){return Y.apply(this,arguments)}function Y(){return(Y=Object(m.a)(f.a.mark((function e(t,a){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M.put(t,a);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(e){return V.apply(this,arguments)}function V(){return(V=Object(m.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object.keys(t).map((function(e){var a;M.clear(e),null===(a=t[e])||void 0===a||a.map((function(t){M.put(e,t)}))}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(){return q.apply(this,arguments)}function q(){return(q=Object(m.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={broad_categories:[],narrow_categories:[],persons:[]},["broad_categories","narrow_categories","persons"].map(function(){var e=Object(m.a)(f.a.mark((function e(a){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M.getAll(a);case 2:n=e.sent,t[a]=n;case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Q(e){return X.apply(this,arguments)}function X(){return(X=Object(m.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M.clear("wallchart");case 2:M.put("wallchart",t);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(){return ee.apply(this,arguments)}function ee(){return(ee=Object(m.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M.getAll("wallchart");case 2:return t=e.sent,e.abrupt("return",t[0]);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(){return ae.apply(this,arguments)}function ae(){return(ae=Object(m.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M.clear("expenses");case 3:return e.next=5,M.clear("income");case 5:return e.abrupt("return","pendingFinances cleared!");case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function ne(){return re.apply(this,arguments)}function re(){return(re=Object(m.a)(f.a.mark((function e(){var t,a,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=localStorage.getItem("token"),e.prev=1,e.next=4,M.getAll("expenses");case 4:if(!((a=e.sent).length>0)){e.next=9;break}return e.next=8,J.postBatchExpenses(t,a);case 8:M.clear("expenses");case 9:return e.next=11,M.getAll("income");case 11:if(!((n=e.sent).length>0)){e.next=16;break}return e.next=15,J.postBatchIncome(t,n);case 15:M.clear("income");case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(1),console.error(e.t0);case 21:case"end":return e.stop()}}),e,null,[[1,18]])})))).apply(this,arguments)}window.addEventListener("online",ne);var oe=a(331),ce=a(146),se=a(321),ie=a(353),le=a(345),ue=a(354),de=a(333),pe=a(86),be=a(25),je=a(343);function he(e){var t=o.a.useContext(ct),a=t.Auth,c=t.setAuth,s=t.setAlertState,l={date:new Date(Date.now()),amount:NaN,person_id:NaN,broad_category_id:NaN,narrow_category_id:NaN,vendor:"",notes:""},p=Object(r.useState)(l),b=Object(i.a)(p,2),j=b[0],h=b[1],O=Object(r.useState)({name:"",id:NaN}),g=Object(i.a)(O,2),x=g[0],v=g[1],y=Object(r.useState)([]),w=Object(i.a)(y,2),C=w[0],S=w[1];function N(t){var a=t.target.name;if(h(Object(d.a)(Object(d.a)({},j),{},Object(u.a)({},a,t.target.value))),"broad_category_id"===a){var n=e.categories.broad_categories.filter((function(e){return e.id===t.target.value}))[0];v(n);var r=e.categories.narrow_categories.filter((function(e){return e.broad_category_id===n.id}));S(r)}}function I(){return(I=Object(m.a)(f.a.mark((function t(n){var r,o;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),j.date&&j.amount&&j.broad_category_id&&j.vendor){t.next=4;break}return s({severity:"error",message:"Please fill out all fields",open:!0}),t.abrupt("return");case 4:return(o=Object(d.a)({},j)).date=null===(r=o.date)||void 0===r?void 0:r.toLocaleDateString("en-US"),t.prev=6,e.setOpenBackdrop(!0),t.next=10,J.postExpenses(a.token,o);case 10:e.setOpenBackdrop(!1),s({severity:"success",message:"Record Saved!",open:!0}),e.reloadWallChart(),t.next=26;break;case 15:if(t.prev=15,t.t0=t.catch(6),e.setOpenBackdrop(!1),"Error! 500"!==t.t0.message){t.next=23;break}return s({severity:"error",message:"Server Error! Contact Eli",open:!0}),t.abrupt("return");case 23:$("expenses",o),"Unauthorized"===t.t0.message&&c({type:"LOGOUT"}),s({severity:"warning",message:"Record Saved Locally",open:!0});case 26:return t.prev=26,h(l),v({name:"",id:NaN}),t.finish(26);case 30:case"end":return t.stop()}}),t,null,[[6,15,26,30]])})))).apply(this,arguments)}return Object(n.jsxs)(oe.a,{children:[Object(n.jsx)(ce.a,{variant:"h5",component:"h5",className:e.classes.root,children:"Log Expense"}),Object(n.jsxs)("form",{className:e.classes.root,onSubmit:function(e){return I.apply(this,arguments)},children:[Object(n.jsx)(be.a,{utils:pe.a,children:Object(n.jsx)(je.a,{disableToolbar:!0,fullWidth:!0,variant:"inline",format:"MM/dd/yyyy",margin:"normal",id:"date-picker-inline",name:"Date",label:"Date",value:j.date,onChange:function(e){h(Object(d.a)(Object(d.a)({},j),{},{date:e}))},KeyboardButtonProps:{"aria-label":"change date"}})}),Object(n.jsx)(k.a,{onChange:N,value:j.vendor,label:"Vendor",name:"vendor",type:"string",InputLabelProps:{shrink:!0}}),Object(n.jsx)(k.a,{onChange:N,value:j.amount,label:"Amount",name:"amount",type:"number",InputProps:{startAdornment:Object(n.jsx)(_.a,{position:"start",children:"$"})},inputProps:{step:"0.01"}}),Object(n.jsxs)(se.a,{className:e.classes.formControl,children:[Object(n.jsx)(ie.a,{htmlFor:"broad_category",children:"Broad Category"}),Object(n.jsx)(le.a,{onChange:N,value:j.broad_category_id,name:"broad_category_id",labelId:"broad_category",label:"Broad Category",children:e.categories.broad_categories.map((function(e){return Object(n.jsx)(ue.a,{value:e.id,children:e.name})}))})]}),C.length>0?Object(n.jsxs)(se.a,{className:e.classes.formControl,children:[Object(n.jsx)(ie.a,{htmlFor:"narrow_category",children:"Narrow Category"}),Object(n.jsx)(le.a,{onChange:N,value:j.narrow_category_id,name:"narrow_category_id",labelId:"narrow_category",label:"Narrow Category",children:null===C||void 0===C?void 0:C.map((function(e){return Object(n.jsx)(ue.a,{value:e.id,children:e.name})}))})]}):null,x.person?Object(n.jsxs)(se.a,{className:e.classes.formControl,children:[Object(n.jsx)(ie.a,{htmlFor:"person_id",children:"Person"}),Object(n.jsx)(le.a,{onChange:N,value:j.person_id,name:"person_id",labelId:"person_id",label:"Person",children:e.categories.persons.map((function(e){return Object(n.jsx)(ue.a,{value:e.id,children:e.name})}))})]}):null,Object(n.jsx)(k.a,{onChange:N,value:j.notes,label:"Notes",name:"notes",type:"string",InputLabelProps:{shrink:!0}}),Object(n.jsx)(de.a,{type:"submit",variant:"contained",color:"primary",children:"Submit"}),Object(n.jsx)(de.a,{type:"button",variant:"contained",color:"secondary",onClick:function(){h(l),e.handleClose()},children:"Close"})]})]})}function fe(e){var t=o.a.useContext(ct),a=t.Auth,c=t.setAuth,s=t.setAlertState,l={date:new Date(Date.now()),amount:NaN,person_id:NaN,source:""},p=Object(r.useState)(l),b=Object(i.a)(p,2),j=b[0],h=b[1];function O(e){var t=e.target.name;h(Object(d.a)(Object(d.a)({},j),{},Object(u.a)({},t,e.target.value)))}function g(){return(g=Object(m.a)(f.a.mark((function t(n){var r,o;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),j.date&&j.amount&&j.person_id&&j.source){t.next=4;break}return s({severity:"error",message:"Please fill out all fields",open:!0}),t.abrupt("return");case 4:return r=Object(d.a)({},j),t.prev=5,r.date=null===(o=r.date)||void 0===o?void 0:o.toLocaleDateString("en-US"),e.setOpenBackdrop(!0),t.next=10,J.postIncome(a.token,r);case 10:e.setOpenBackdrop(!1),s({severity:"success",message:"Record Saved!",open:!0}),e.reloadWallChart(),t.next=26;break;case 15:if(t.prev=15,t.t0=t.catch(5),e.setOpenBackdrop(!1),"Error! 500"!==t.t0.message){t.next=23;break}return s({severity:"error",message:"Server Error!",open:!0}),t.abrupt("return");case 23:$("income",r),s({severity:"warning",message:"Record Saved Locally",open:!0}),"Unauthorized"===t.t0.message&&c({type:"LOGOUT"});case 26:return t.prev=26,h(l),t.finish(26);case 29:case"end":return t.stop()}}),t,null,[[5,15,26,29]])})))).apply(this,arguments)}return Object(n.jsxs)(oe.a,{children:[Object(n.jsx)(ce.a,{variant:"h5",component:"h5",className:e.classes.root,children:"Log Income"}),Object(n.jsxs)("form",{className:e.classes.root,onSubmit:function(e){return g.apply(this,arguments)},children:[Object(n.jsx)(be.a,{utils:pe.a,children:Object(n.jsx)(je.a,{disableToolbar:!0,variant:"inline",format:"MM/dd/yyyy",margin:"normal",id:"date-picker-inline",name:"Date",label:"Date",value:j.date,onChange:function(e){h(Object(d.a)(Object(d.a)({},j),{},{date:e}))},KeyboardButtonProps:{"aria-label":"change date"}})}),Object(n.jsx)(k.a,{onChange:O,value:j.source,label:"Source",name:"source",type:"string",InputLabelProps:{shrink:!0}}),Object(n.jsx)(k.a,{onChange:O,value:j.amount,label:"Amount",name:"amount",type:"number",InputProps:{startAdornment:Object(n.jsx)(_.a,{position:"start",children:"$"})},inputProps:{step:"0.01"}}),Object(n.jsxs)(se.a,{className:e.classes.formControl,children:[Object(n.jsx)(ie.a,{htmlFor:"person_id",children:"Person"}),Object(n.jsx)(le.a,{onChange:O,value:j.person_id,name:"person_id",labelId:"person_id",label:"Person",children:e.categories.persons.map((function(e){return Object(n.jsx)(ue.a,{value:e.id,children:e.name})}))})]}),Object(n.jsx)(de.a,{type:"submit",variant:"contained",color:"primary",children:"Submit"}),Object(n.jsx)(de.a,{type:"button",variant:"contained",color:"secondary",onClick:function(){h(l),e.handleClose()},children:"Close"})]})]})}var me=a(33),Oe=a(344),ge=a(338),xe=a(335),ve=a(332),ye=a(280),we=a(334),ke=a(355),_e=a(356),Ce=a(348),Se=a(107),Ne=a.n(Se),Ie=Object(S.a)((function(e){return Object(N.a)({head:{backgroundColor:e.palette.primary.main,color:e.palette.common.white,padding:10,fontSize:16},body:{padding:10,fontSize:14}})}))(y.a),Ee=Object(S.a)((function(e){return Object(N.a)({root:{backgroundColor:e.palette.background.default,cursor:"pointer"}})}))(w.a),Le=Object(S.a)((function(e){return Object(N.a)({root:{backgroundColor:I.a[800]}})}))(w.a),Be=Object(S.a)((function(e){return Object(N.a)({root:{backgroundColor:I.a[700]}})}))(w.a);function Ae(e){var t=Object(r.useState)([!1]),a=Object(i.a)(t,2),o=a[0],c=a[1];var s=e.state.data.reduce((function(e,t){if(t.broad_category)if(e[t.broad_category]?e[t.broad_category].total+=parseFloat(t.amount):e[t.broad_category]={total:parseFloat(t.amount),narrow_categories:{}},t.narrow_category)e[t.broad_category].narrow_categories[t.narrow_category]?e[t.broad_category].narrow_categories[t.narrow_category].total+=parseFloat(t.amount):e[t.broad_category].narrow_categories[t.narrow_category]={total:parseFloat(t.amount),persons:{}},t.person&&(e[t.broad_category].narrow_categories[t.narrow_category].persons[t.person]?e[t.broad_category].narrow_categories[t.narrow_category].persons[t.person]+=parseFloat(t.amount):e[t.broad_category].narrow_categories[t.narrow_category].persons[t.person]=parseFloat(t.amount));else if(t.person){var a;(null===(a=e[t.broad_category].narrow_categories["--"])||void 0===a?void 0:a.persons[t.person])?(e[t.broad_category].narrow_categories["--"].persons[t.person]+=parseFloat(t.amount),e[t.broad_category].narrow_categories["--"].total+=parseFloat(t.amount)):e[t.broad_category].narrow_categories=Object(d.a)(Object(d.a)({},e[t.broad_category].narrow_categories),{},{"--":{persons:Object(u.a)({},t.person,parseFloat(t.amount)),total:parseFloat(t.amount)}})}return e}),{});return console.log(s),Object(r.useEffect)((function(){var e=Object.keys(s).map((function(e){return!1}));c(e)}),[e]),Object(n.jsx)(P.a,{component:U.a,children:Object(n.jsxs)(A.a,{children:[Object(n.jsx)(F.a,{children:Object(n.jsxs)(w.a,{children:[Object(n.jsx)(Ie,{children:"Broad category"}),Object(n.jsx)(Ie,{children:"Narrow Category"}),Object(n.jsx)(Ie,{children:"person"}),Object(n.jsx)(Ie,{children:"amount"})]})}),Object(n.jsx)(T.a,{children:Object.keys(s).map((function(e,t){return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)(Ee,{onClick:function(){return function(e){var t=Object(j.a)(o);t[e]=!t[e],c(t)}(t)},children:[Object(n.jsx)(Ie,{children:e}),Object(n.jsx)(Ie,{children:"TOTAL"}),Object(n.jsx)(Ie,{}),Object(n.jsxs)(Ie,{children:["$",s[e].total.toFixed(2)]})]},t),s[e].narrow_categories&&o[t]?Object.keys(s[e].narrow_categories).map((function(t){return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)(Le,{children:[Object(n.jsx)(Ie,{}),Object(n.jsx)(Ie,{children:t}),Object(n.jsx)(Ie,{children:"TOTAL"}),Object(n.jsxs)(Ie,{children:["$",s[e].narrow_categories[t].total.toFixed(2)]})]}),s[e].narrow_categories[t].persons?Object.keys(s[e].narrow_categories[t].persons).map((function(a){return Object(n.jsxs)(Be,{children:[Object(n.jsx)(Ie,{}),Object(n.jsx)(Ie,{}),Object(n.jsx)(Ie,{children:a}),Object(n.jsxs)(Ie,{children:["$",s[e].narrow_categories[t].persons[a].toFixed(2)]})]})})):null]})})):null]})}))})]})})}var Te=a(336);function Pe(e){var t=e.classes,a=e.handleFormSubmit,r=e.handleFormChange,o=e.formState;return Object(n.jsx)(xe.a,{className:t.root,children:Object(n.jsxs)(Te.a,{variant:"outlined",children:[Object(n.jsx)("h2",{className:t.root,children:"Reports"}),Object(n.jsxs)("form",{onSubmit:a,className:t.root,children:[Object(n.jsxs)(se.a,{variant:"outlined",className:t.formControl,children:[Object(n.jsx)(ie.a,{htmlFor:"form",children:"Report"}),Object(n.jsxs)(le.a,{name:"form",label:"Report",labelId:"form",value:o.form,onChange:r,children:[Object(n.jsx)(ue.a,{value:"income",children:"Income"}),Object(n.jsx)(ue.a,{value:"expenses",children:"Expenses"}),Object(n.jsx)(ue.a,{value:"pivot",children:"Pivot Table"})]})]}),Object(n.jsx)(k.a,{onChange:r,value:o.year,label:"Year",name:"year",type:"number",variant:"outlined"}),Object(n.jsxs)(se.a,{variant:"outlined",className:t.formControl,children:[Object(n.jsx)(ie.a,{htmlFor:"month2",children:"Month"}),Object(n.jsxs)(le.a,{onChange:r,value:o.month,name:"month",labelId:"month2",label:"Month",children:[Object(n.jsx)(ue.a,{value:1,children:"January"}),Object(n.jsx)(ue.a,{value:2,children:"February"}),Object(n.jsx)(ue.a,{value:3,children:"March"}),Object(n.jsx)(ue.a,{value:4,children:"April"}),Object(n.jsx)(ue.a,{value:5,children:"May"}),Object(n.jsx)(ue.a,{value:6,children:"June"}),Object(n.jsx)(ue.a,{value:7,children:"July"}),Object(n.jsx)(ue.a,{value:8,children:"August"}),Object(n.jsx)(ue.a,{value:9,children:"September"}),Object(n.jsx)(ue.a,{value:10,children:"October"}),Object(n.jsx)(ue.a,{value:11,children:"November"}),Object(n.jsx)(ue.a,{value:12,children:"December"})]})]}),Object(n.jsx)(de.a,{type:"submit",variant:"contained",color:"primary",children:"View"})]})]})})}var Fe=a(138);function Ue(e){var t=e.data;return Object(n.jsx)(xe.a,{children:Object(n.jsx)(Fe.Line,{data:t})})}var De=a(337),ze=a(347);function We(e){var t=o.a.useContext(ct),a=t.Auth,c=t.setAuth,s=t.setAlertState,l={person:"",broad_category:"",broad_category_id:NaN,narrow_category:"",has_person:!1},p=Object(r.useState)(l),b=Object(i.a)(p,2),j=b[0],h=b[1];function O(e){var t=e.target.name,a=e.target.value;"has_person"===t&&(a=e.target.checked),h(Object(d.a)(Object(d.a)({},j),{},Object(u.a)({},t,a)))}function g(e,t){return x.apply(this,arguments)}function x(){return(x=Object(m.a)(f.a.mark((function t(n,r){var o,i;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.preventDefault(),e.setOpenBackdrop(!0),t.prev=2,t.t0=r,t.next="person"===t.t0?6:"broad_category"===t.t0?10:"narrow_category"===t.t0?14:18;break;case 6:if((o={person:j.person}).person){t.next=9;break}throw new Error("Empty Input");case 9:return t.abrupt("break",18);case 10:if((o={broad_category:j.broad_category,has_person:j.has_person}).broad_category){t.next=13;break}throw new Error("Empty Input");case 13:return t.abrupt("break",18);case 14:if((o={narrow_category:j.narrow_category,broad_category_id:j.broad_category_id,has_person:j.has_person}).narrow_category&&o.broad_category_id){t.next=17;break}throw new Error("Empty Input");case 17:return t.abrupt("break",18);case 18:return t.next=20,J.addCategories(a.token,o);case 20:return s({severity:"success",message:"Category Added!",open:!0}),t.next=23,J.getCategories(a.token);case 23:i=t.sent,e.setCategories(i),t.next=39;break;case 27:t.prev=27,t.t1=t.catch(2),t.t2=t.t1.message,t.next="Error! 500"===t.t2?32:"Unauthorized"===t.t2?34:"Empty Input"===t.t2?36:38;break;case 32:return s({severity:"error",message:"Server Error!",open:!0}),t.abrupt("break",39);case 34:return c({type:"LOGOUT"}),t.abrupt("break",39);case 36:return s({severity:"error",message:"Please fill out all fields",open:!0}),t.abrupt("break",39);case 38:s({severity:"error",message:"You must be connected to the internet to add categories",open:!0});case 39:return t.prev=39,e.setOpenBackdrop(!1),h(l),t.finish(39);case 43:case"end":return t.stop()}}),t,null,[[2,27,39,43]])})))).apply(this,arguments)}return Object(n.jsxs)(oe.a,{children:[Object(n.jsx)(ce.a,{variant:"h5",component:"h5",className:e.classes.root,children:"Add a Person"}),Object(n.jsxs)("form",{className:e.classes.root,onSubmit:function(e){return g(e,"person")},children:[Object(n.jsx)(k.a,{onChange:O,value:j.person,label:"Person",name:"person",type:"string"}),Object(n.jsx)(de.a,{type:"submit",variant:"contained",color:"primary",children:"Add"})]}),Object(n.jsx)(ce.a,{variant:"h5",component:"h5",className:e.classes.root,children:"Add a Broad Category"}),Object(n.jsxs)("form",{className:e.classes.root,onSubmit:function(e){return g(e,"broad_category")},children:[Object(n.jsx)(k.a,{onChange:O,value:j.broad_category,label:"Broad Category",name:"broad_category",type:"string"}),Object(n.jsx)(De.a,{control:Object(n.jsx)(ze.a,{checked:j.has_person,onChange:O,name:"has_person",inputProps:{"aria-label":"primary checkbox"}}),label:"Person"}),Object(n.jsx)(de.a,{type:"submit",variant:"contained",color:"primary",children:"Add"})]}),Object(n.jsx)(ce.a,{variant:"h5",component:"h5",className:e.classes.root,children:"Add a Narrow Category"}),Object(n.jsxs)("form",{className:e.classes.root,onSubmit:function(e){return g(e,"narrow_category")},children:[Object(n.jsxs)(se.a,{className:e.classes.formControl,children:[Object(n.jsx)(ie.a,{htmlFor:"broad_category",children:"Broad Category"}),Object(n.jsx)(le.a,{onChange:O,name:"broad_category_id",labelId:"broad_category_id",label:"Broad Category",children:e.categories.broad_categories.map((function(e){return Object(n.jsx)(ue.a,{value:e.id,children:e.name})}))})]}),Object(n.jsx)(k.a,{onChange:O,value:j.narrow_category,label:"Narrow Category",name:"narrow_category",type:"string"}),Object(n.jsx)(de.a,{type:"submit",variant:"contained",color:"primary",children:"Add"})]}),Object(n.jsx)("div",{className:e.classes.root,children:Object(n.jsx)(de.a,{type:"button",variant:"contained",color:"secondary",onClick:function(){e.handleClose()},children:"Close"})})]})}var Me=function(){var e,t,a,c=Object(me.a)(),s=o.a.useContext(ct),l=s.Auth,p=s.setAuth,b=s.setAlertState,h=Object(r.useState)({form:"expenses",year:new Date(Date.now()).getUTCFullYear(),month:new Date(Date.now()).getUTCMonth()+1}),O=Object(i.a)(h,2),g=O[0],x=O[1],v=Object(r.useState)({schema:{fields:[]},data:[{amount:"",date:"",source:"",person:"",id:NaN,person_id:NaN}]}),y=Object(i.a)(v,2),w=y[0],k=y[1],_=Object(r.useState)({schema:{fields:[]},data:[{amount:"",date:"",source:"",vendor:"",broad_category:"",narrow_category:"",person:"",notes:"",id:NaN}]}),C=Object(i.a)(_,2),S=C[0],I=C[1],E=Object(r.useState)({persons:[],narrow_categories:[],broad_categories:[]}),L=Object(i.a)(E,2),B=L[0],A=L[1],T=Object(r.useState)(!1),P=Object(i.a)(T,2),F=P[0],U=P[1];function W(e){if(e.date){var t=new Date(e.date),a=t.getUTCFullYear(),n=(1+t.getUTCMonth()).toString();n=n.length>1?n:"0"+n;var r=t.getUTCDate().toString(),o=n+"/"+(r=r.length>1?r:"0"+r)+"/"+a;return e.date=o,e}return e}function M(){return(M=Object(m.a)(f.a.mark((function e(t){var a,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.preventDefault(),a=g.form,U(!0),e.next=6,J[a](l.token,g);case 6:n=e.sent,U(!1),"pivot"!==a&&(n.data=n.data.map(W)),e.t0=a,e.next="expenses"===e.t0?12:"income"===e.t0?14:"pivot"===e.t0?16:18;break;case 12:return I(n),e.abrupt("break",18);case 14:return k(n),e.abrupt("break",18);case 16:return I(n),e.abrupt("break",18);case 18:e.next=25;break;case 20:e.prev=20,e.t1=e.catch(0),"Unauthorized"===e.t1.message&&p({type:"LOGOUT"}),U(!1),b({severity:"error",message:"Error Fetching Data",open:!0});case 25:case"end":return e.stop()}}),e,null,[[0,20]])})))).apply(this,arguments)}function R(e,t){var a,n;switch(e){case"person":a=B.persons,n="person_id";break;case"broad_category":a=B.broad_categories,n="broad_category_id";break;case"narrow_category":a=B.narrow_categories,n="narrow_category_id"}var r=a.filter((function(e){return e.name===t}))[0];return r?{id:n,dataListItem:r}:{id:null,dataListItem:null}}function G(){return(G=Object(m.a)(f.a.mark((function e(t,a){var n,r,o,c,s,i,l,b;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{n=t.target,r=n.name,o=n.value,c=Object(j.a)(S.data),s=Object(d.a)(Object(d.a)({},c[a]),{},Object(u.a)({},r,o)),"person"!==r&&"broad_category"!==r&&"narrow_category"!==r||(i=R(r,o),l=i.id,b=i.dataListItem,l&&b&&(s=Object(d.a)(Object(d.a)({},s),{},Object(u.a)({},l,b.id)))),c[a]=s,I(Object(d.a)(Object(d.a)({},S),{},{data:c}))}catch(h){console.error(h),"Unauthorized"===h.message&&p({type:"LOGOUT"})}case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $(){return($=Object(m.a)(f.a.mark((function e(t,a){var n,r,o,c,s,i,l,p;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{n=t.target,r=n.name,o=n.value,c=Object(j.a)(w.data),s=Object(d.a)(Object(d.a)({},c[a]),{},Object(u.a)({},r,o)),"person"===r&&(i=R(r,o),l=i.id,p=i.dataListItem,l&&p&&(s=Object(d.a)(Object(d.a)({},s),{},Object(u.a)({},l,p.id)))),c[a]=s,k(Object(d.a)(Object(d.a)({},w),{},{data:c}))}catch(b){console.error(b)}case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(){return(Y=Object(m.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,J.updateExpenses(l.token,S.data[t]);case 3:b({severity:"success",message:"Record updated!",open:!0}),ne(),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0),b({severity:"error",message:"Error: Failed to save!",open:!0});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function V(){return(V=Object(m.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,J.updateIncome(l.token,w.data[t]);case 3:b({severity:"success",message:"Record updated!",open:!0}),ne(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),b({severity:"error",message:"Error: Failed to save!",open:!0});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}var q=Object(r.useReducer)((function(e,t){return t.labels.length>0&&(e={labels:t.labels,datasets:[{label:"Income",data:t.income,fill:!1,borderColor:c.palette.primary.main},{label:"Expenses",data:t.expenses,fill:!1,borderColor:c.palette.secondary.main}]}),e}),{labels:[],datasets:[{label:"Income",data:[],fill:!1,borderColor:c.palette.primary.main},{label:"Expenses",data:[],fill:!1,borderColor:c.palette.secondary.main}]}),X=Object(i.a)(q,2),ee=X[0],ae=X[1];function ne(){return re.apply(this,arguments)}function re(){return(re=Object(m.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Reloading Wallchart"),e.prev=1,e.next=4,J.wallchart(l.token);case 4:t=e.sent,console.log(t),ae(t),Q(t),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),"No Data"===e.t0.message?console.log("No Data!"):Z().then((function(e){return ae(e)}));case 13:case"end":return e.stop()}}),e,null,[[1,10]])})))).apply(this,arguments)}function oe(e){return ce.apply(this,arguments)}function ce(){return(ce=Object(m.a)(f.a.mark((function e(t){var a,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"expenses"!==g.form){e.next=8;break}return e.next=4,J.deleteExpenses(l.token,t);case 4:a=S.data.filter((function(e){return e.id!==t})),I(Object(d.a)(Object(d.a)({},S),{},{data:a})),e.next=13;break;case 8:if("income"!==g.form){e.next=13;break}return e.next=11,J.deleteIncome(l.token,t);case 11:n=w.data.filter((function(e){return e.id!==t})),k(Object(d.a)(Object(d.a)({},w),{},{data:n}));case 13:ne(),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(0),console.error(e.t0),"Unauthorized"===e.t0&&p({type:"LOGOUT"});case 20:case"end":return e.stop()}}),e,null,[[0,16]])})))).apply(this,arguments)}var se=Object(D.a)((function(e){var t;return Object(N.a)({formControl:{margin:e.spacing(1),minWidth:"10em"},selectEmpty:{marginTop:e.spacing(2)},root:(t={display:"flex",justifyContent:"center",flexWrap:"wrap"},Object(u.a)(t,e.breakpoints.up("md"),{flexWrap:"noWrap"}),Object(u.a)(t,"& > *",Object(u.a)({margin:e.spacing(1)},e.breakpoints.down("xs"),{width:"100%"})),t),wallchart:{width:"100%"},logoutBtn:{float:"right",margin:"1em"},editBtn:{float:"left",margin:"1em"},offline:{backgroundColor:e.palette.secondary.main,color:"white",textAlign:"center",position:"sticky"},backdrop:{zIndex:1301,color:"#fff"},speedDial:{position:"fixed",bottom:e.spacing(2),right:e.spacing(2)},dialog:{width:"100%"},datePicker:Object(u.a)({},e.breakpoints.down("sm"),{marginLeft:"-10px"})})}))(),ie=o.a.useState(!1),le=Object(i.a)(ie,2),ue=le[0],pe=le[1],be=[{icon:Object(n.jsx)(Ne.a,{}),name:"Expenses",action:function(){Ee(!0),pe(!1)},operation:"product"},{icon:Object(n.jsx)(Ne.a,{}),name:"Income",action:function(){Fe(!0),pe(!1)},operation:"tag"}],je=Object(r.useState)(!1),Se=Object(i.a)(je,2),Ie=Se[0],Ee=Se[1],Le=Object(r.useState)(!1),Be=Object(i.a)(Le,2),Te=Be[0],Fe=Be[1],De=Object(r.useState)(!1),ze=Object(i.a)(De,2),Me=ze[0],Je=ze[1];function Re(){Ee(!1),Fe(!1),Je(!1)}var Ge=Object(r.useState)(!1),$e=Object(i.a)(Ge,2),Ye=$e[0],He=$e[1];return window.addEventListener("offline",(function(){return He(!0)})),window.addEventListener("online",(function(){return He(!1)})),Object(r.useEffect)((function(){function e(){return(e=Object(m.a)(f.a.mark((function e(){var t,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,J.getCategories(l.token);case 3:t=e.sent,A(t),H(t),e.next=14;break;case 8:return e.prev=8,e.t0=e.catch(0),e.next=12,K();case 12:a=e.sent,A(a);case 14:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}(),navigator.onLine||He(!0),ne()}),[]),Object(n.jsxs)(Oe.a,{component:"div",className:"Home",children:[Ye?Object(n.jsx)(ge.a,{className:se.offline,position:"sticky",children:"Offline"}):null,Object(n.jsxs)(Oe.a,{component:"header",className:"header",children:[Object(n.jsx)(de.a,{variant:"contained",color:"primary",className:se.editBtn,onClick:function(){return Je(!0)},children:"Edit"}),Object(n.jsx)(de.a,{variant:"contained",color:"primary",className:se.logoutBtn,onClick:Object(m.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p({type:"LOGOUT"}),e.next=3,te();case 3:t=e.sent,console.log(t);case 5:case"end":return e.stop()}}),e)}))),children:"Logout"}),Object(n.jsx)(xe.a,{className:se.root,children:Object(n.jsxs)("h1",{style:{textAlign:"center"},children:[l.user," Finances"]})}),Object(n.jsx)(Ue,{data:ee}),Object(n.jsx)(Pe,{classes:se,handleFormSubmit:function(e){return M.apply(this,arguments)},handleFormChange:function(e){var t=e.target.name;x(Object(d.a)(Object(d.a)({},g),{},Object(u.a)({},t,e.target.value)))},formState:g})]}),Object(n.jsxs)("div",{className:"body",children:["income"===g.form&&(null===(e=w.data[0])||void 0===e?void 0:e.id)?Object(n.jsx)(z,{state:w,dataLists:B,handleChange:function(e,t){return $.apply(this,arguments)},handleUpdate:function(e){return V.apply(this,arguments)},deleteEntry:oe,form:g.form}):null,"expenses"===g.form&&(null===(t=S.data[0])||void 0===t?void 0:t.id)?Object(n.jsx)(z,{state:S,dataLists:B,handleChange:function(e,t){return G.apply(this,arguments)},handleUpdate:function(e){return Y.apply(this,arguments)},deleteEntry:oe,form:g.form}):null,"pivot"===g.form&&(null===(a=S.data[0])||void 0===a?void 0:a.id)?Object(n.jsx)(Ae,{state:S}):null]}),Object(n.jsx)(ve.a,{onClose:Re,open:Me,maxWidth:"xl",children:Object(n.jsx)(We,{classes:se,handleClose:Re,categories:B,setCategories:A,setOpenBackdrop:U})}),Object(n.jsx)(ve.a,{onClose:Re,open:Ie,maxWidth:"xl",children:Object(n.jsx)(he,{classes:se,handleClose:Re,categories:B,setOpenBackdrop:U,reloadWallChart:ne})}),Object(n.jsx)(ve.a,{onClose:Re,open:Te,maxWidth:"xl",children:Object(n.jsx)(fe,{classes:se,handleClose:Re,categories:B,setOpenBackdrop:U,reloadWallChart:ne})}),Object(n.jsx)(ke.a,{ariaLabel:"SpeedDial example",className:se.speedDial,icon:Object(n.jsx)(_e.a,{}),onClose:function(){pe(!1)},onOpen:function(){pe(!0)},open:ue,onMouseLeave:function(){},children:be.map((function(e){return Object(n.jsx)(Ce.a,{icon:e.icon,tooltipTitle:e.name,tooltipOpen:!0,onClick:e.action},e.name)}))}),Object(n.jsx)(ye.a,{className:se.backdrop,open:F,children:Object(n.jsx)(we.a,{disableShrink:!0,color:"inherit"})})]})},Je=Object(D.a)((function(e){return Object(N.a)({root:{display:"flex",justifyContent:"center",flexWrap:"wrap","& > *":Object(u.a)({margin:e.spacing(1)},e.breakpoints.down("xs"),{width:"100%"})}})}));function Re(e){var t=e.handleClose,a=o.a.useContext(ct).setAlertState,c=Object(r.useState)({username:"",password:""}),s=Object(i.a)(c,2),l=s[0],p=s[1],b=function(e){var t=e.target,a=t.name,n=t.value;p(Object(d.a)(Object(d.a)({},l),{},Object(u.a)({},a,n)))},j=function(){var e=Object(m.a)(f.a.mark((function e(n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,J.signup(l);case 4:a({severity:"success",message:"You're signed up! Please log in",open:!0}),t(),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),console.error(e.t0),a({severity:"error",message:"Error Signing Up!",open:!0});case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),h=Je();return Object(n.jsx)(oe.a,{children:Object(n.jsxs)("div",{style:{textAlign:"center"},children:[Object(n.jsx)("h4",{children:"Signup"}),Object(n.jsxs)("form",{className:h.root,onSubmit:j,children:[Object(n.jsx)(k.a,{onChange:b,value:l.username,type:"text",name:"username",label:"username",variant:"outlined"}),Object(n.jsx)(k.a,{onChange:b,value:l.password,type:"password",name:"password",label:"password",variant:"outlined"}),Object(n.jsx)(de.a,{variant:"contained",color:"primary",name:"signup",type:"submit",children:"Sign Up"})]})]})})}var Ge=Object(D.a)((function(e){return Object(N.a)({root:{display:"flex",justifyContent:"center",textAlign:"center",flexWrap:"wrap","& > *":Object(u.a)({margin:e.spacing(1)},e.breakpoints.down("xs"),{width:"100%"})},signupBtn:{float:"right",margin:"1em"}})}));function $e(){var e=o.a.useContext(ct),t=e.Auth,a=e.setAuth,c=e.setAlertState,s=Object(r.useState)({username:"",password:""}),l=Object(i.a)(s,2),b=l[0],j=l[1],h=Object(r.useState)(!1),O=Object(i.a)(h,2),g=O[0],x=O[1],v=function(e){var t=e.target,a=t.name,n=t.value;j(Object(d.a)(Object(d.a)({},b),{},Object(u.a)({},a,n)))},y=function(){var e=Object(m.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,J.login(b).then((function(e){a({type:"LOGIN",payload:{user:b.username,token:e.token}})}));case 4:e.next=10;break;case 6:e.prev=6,e.t0=e.catch(1),console.error(e.t0),c({severity:"error",message:"Incorrect username or password",open:!0});case 10:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}(),w=Ge();function _(){x(!1)}return t.loggedIn?Object(n.jsx)(p.a,{to:"/"}):Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(de.a,{className:w.signupBtn,variant:"contained",color:"primary",onClick:function(){return x(!0)},children:"Sign Up"}),Object(n.jsxs)(xe.a,{className:w.root,children:[Object(n.jsx)("h4",{children:"Login"}),Object(n.jsxs)("form",{className:w.root,onSubmit:y,children:[Object(n.jsx)(k.a,{onChange:v,value:b.username,type:"text",name:"username",label:"username",variant:"outlined"}),Object(n.jsx)(k.a,{onChange:v,value:b.password,type:"password",name:"password",label:"password",variant:"outlined"}),Object(n.jsx)(de.a,{variant:"contained",color:"primary",name:"login",type:"submit",children:"Login"})]})]}),Object(n.jsx)(ve.a,{onClose:_,open:g,maxWidth:"xl",children:Object(n.jsx)(Re,{handleClose:_})})]})}a(276);var Ye=a(349),He=a(346);function Ve(e){return Object(n.jsx)(He.a,Object(d.a)({elevation:6,variant:"filled"},e))}var Ke=Object(D.a)((function(e){return{snackbar:{width:"100%","& > * + *":{marginTop:e.spacing(2)}}}}));function qe(e){var t=e.state,a=e.setState,r=Ke(),o=function(e,n){"clickaway"!==n&&a(Object(d.a)(Object(d.a)({},t),{},{open:!1}))};return Object(n.jsx)("div",{className:r.snackbar,children:Object(n.jsx)(Ye.a,{open:t.open,autoHideDuration:3e3,onClose:o,children:Object(n.jsx)(Ve,{onClose:o,severity:t.severity,children:t.message})})})}var Qe=a(140),Xe=a(341),Ze=a(87),et=a(340),tt=a(342),at=Object(Qe.a)();var nt,rt=(nt={palette:{type:"dark",background:{default:I.a[900]},primary:{main:Ze.a[900]},secondary:{main:et.a[800]}}},Object(Qe.a)(Object(d.a)({overrides:{MuiPickersBasePicker:{container:Object(u.a)({backgroundColor:I.a[900]},at.breakpoints.down("xs"),{marginLeft:"-10px"})},MuiCard:{root:{backgroundColor:I.a[900]}},MuiDialogContent:{root:{backgroundColor:I.a[900]}},MuiPickersCalendarHeader:{iconButton:{backgroundColor:I.a[900]}}}},nt))),ot=function(e){var t=e.component,a=e.loggedIn,r=Object(l.a)(e,["component","loggedIn"]);return Object(n.jsx)(p.b,Object(d.a)(Object(d.a)({},r),{},{render:function(e){return a?Object(n.jsx)(t,Object(d.a)({},e)):Object(n.jsx)(p.a,{to:"/login"})}}))},ct=o.a.createContext({Auth:{loggedIn:!1,user:"",token:""},setAuth:function(){},setAlertState:function(){}});function st(){var e=Object(r.useReducer)((function(e,t){return"LOGIN"===t.type&&t.payload?(localStorage.setItem("user",t.payload.user),localStorage.setItem("token",t.payload.token),Object(d.a)(Object(d.a)({},e),{},{loggedIn:!0,user:t.payload.user,token:t.payload.token})):"LOGOUT"===t.type?(localStorage.clear(),Object(d.a)(Object(d.a)({},e),{},{loggedIn:!1,user:"",token:""})):e}),{loggedIn:!1,user:"",token:""}),t=Object(i.a)(e,2),a=t[0],o=t[1],c=Object(r.useState)({severity:void 0,message:"",open:!1}),s=Object(i.a)(c,2),l=s[0],u=s[1];return Object(r.useEffect)((function(){var e=localStorage.getItem("token"),t=localStorage.getItem("user");e&&J.checkAuth(e).then((function(t){return o({type:"LOGIN",payload:{user:t.username,token:e}})})).catch((function(a){"Unauthorized"===a.message?o({type:"LOGOUT"}):o({type:"LOGIN",payload:{user:t||"",token:e||""}})}))}),[]),Object(r.useEffect)((function(){!function(){G.apply(this,arguments)}()})),Object(n.jsxs)(Xe.a,{theme:rt,children:[Object(n.jsx)(tt.a,{}),Object(n.jsxs)(ct.Provider,{value:{Auth:a,setAuth:o,setAlertState:u},children:[Object(n.jsxs)(b.a,{children:[Object(n.jsx)(ot,{path:"/",loggedIn:a.loggedIn,setLoggedIn:o,component:Me}),Object(n.jsx)(p.b,{exact:!0,path:"/login",children:Object(n.jsx)($e,{})})]}),Object(n.jsx)(qe,{state:l,setState:u})]})]})}var it=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function lt(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var ut=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,359)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,o=t.getLCP,c=t.getTTFB;a(e),n(e),r(e),o(e),c(e)}))};s.a.render(Object(n.jsx)(st,{}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");it?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):lt(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):lt(t,e)}))}}(),ut()}},[[277,1,2]]]);
//# sourceMappingURL=main.c509b0db.chunk.js.map